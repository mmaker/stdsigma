<!DOCTYPE html>
<html lang="en" class="Internet-Draft">
<head>
<meta charset="utf-8">
<meta content="Common,Latin" name="scripts">
<meta content="initial-scale=1.0" name="viewport">
<title>Fiat-Shamir Heuristic</title>
<meta content="Michele OrrÃ¹" name="author">
<meta content="
       This document describes the Fiat-Shamir transform. 
    " name="description">
<meta content="xml2rfc 3.21.0" name="generator">
<meta content="zero knowledge" name="keyword">
<meta content="hash" name="keyword">
<meta content="draft-orru-zkproof-fiat-shamir-latest" name="ietf.draft">
<!-- Generator version information:
  xml2rfc 3.21.0
    Python 3.11.9
    ConfigArgParse 1.7
    google-i18n-address 3.1.0
    intervaltree 3.1.0
    Jinja2 3.1.2
    lxml 4.9.3
    platformdirs 4.2.0
    pycountry 22.3.5
    PyYAML 6.0.1
    requests 2.31.0
    setuptools 68.2.2
    six 1.16.0
    wcwidth 0.2.13
-->
<link href="draft-orru-zkproof-fiat-shamir.xml" rel="alternate" type="application/rfc+xml">
<link href="#copyright" rel="license">
<style type="text/css">@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}

@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-cyrillic.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-cyrillic.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 600;
  font-display: swap;
  src: local('Lora SemiBold'), local('Lora-SemiBold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-semibold-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Cabin Condensed';
  font-style: normal;
  font-weight: 600;
  font-display: swap;
  src: local('Cabin Condensed SemiBold'), local('CabinCondensed-SemiBold'), url('https://martinthomson.github.io/rfc-css/fonts/cabincondensed-semibold-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Cabin Condensed';
  font-style: normal;
  font-weight: 600;
  font-display: swap;
  src: local('Cabin Condensed SemiBold'), local('CabinCondensed-SemiBold'), url('https://martinthomson.github.io/rfc-css/fonts/cabincondensed-semibold-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Cabin Condensed';
  font-style: normal;
  font-weight: 600;
  font-display: swap;
  src: local('Cabin Condensed SemiBold'), local('CabinCondensed-SemiBold'), url('https://martinthomson.github.io/rfc-css/fonts/cabincondensed-semibold-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Oxygen Mono';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Oxygen Mono'), local('OxygenMono-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/oxygenmono-regular-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Oxygen Mono';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Oxygen Mono'), local('OxygenMono-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/oxygenmono-regular-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

:root {
  color-scheme: light dark;
  --background-color: #fff;
  --text-color: #222;
  --title-color: #191919;
  --link-color: #2a6496;
  --highlight-color: #f9f9f9;
  --line-color: #eee;
  --pilcrow-weak: #ddd;
  --pilcrow-strong: #bbb;
  --small-font-size: 14.5px;
  --font-mono: 'Oxygen Mono', monospace;
  scrollbar-color: #bbb #eee;
}
body {
  max-width: 600px;
  margin: 75px auto;
  padding: 0 5px;
  color: var(--text-color);
  background-color: var(--background-color);
  font: 16px/22px "Lora", serif;
  scroll-behavior: smooth;
}

.ears {
  display: none;
}

/* headings */
h1, h2, h3, h4, h5, h6 {
  font-family: "Cabin Condensed", sans-serif;
  font-weight: 600;
  margin: 0.8em 0 0.3em;
  font-size-adjust: 0.5;
  color: var(--title-color);
}
h1#title {
  font-size: 32px;
  line-height: 40px;
  clear: both;
}
h1#title, h1#rfcnum {
  margin: 1.5em 0 0.2em;
}
h1#rfcnum + h1#title {
  margin: 0.2em 0;
}

h1, h2, h3 {
  font-size: 22px;
  line-height: 27px;
}
h4, h5, h6 {
  font-size: 20px;
  line-height: 24px;
}

/* general structure */
.author {
  padding-bottom: 0.3em;
}
#abstract+p {
  font-size: 18px;
  line-height: 24px;
}
#abstract+p code, #abstract+p samp, #abstract+p tt {
  font-size: 16px;
  line-height: 0;
}

p {
  padding: 0;
  margin: 0.5em 0;
  text-align: left;
}
div {
  margin: 0;
}
.alignRight.art-text {
  background-color: var(--highlight-color);
  border: 1px solid var(--line-color);
  border-radius: 3px;
  padding: 0.5em 1em 0;
  margin-bottom: 0.5em;
}
.alignRight.art-text pre {
  padding: 0;
  width: auto;
}
.alignRight {
  margin: 1em 0;
}
.alignRight > *:first-child {
  border: none;
  margin: 0;
  float: right;
  clear: both;
}
.alignRight > *:nth-child(2) {
  clear: both;
  display: block;
  border: none;
}
svg {
  display: block;
}
/* font-family isn't space-separated, but =~ will have to do */
svg[font-family~="monospace" i], svg [font-family~="monospace" i] {
  font-family: var(--font-mono);
}
.alignCenter.art-text {
  background-color: var(--highlight-color);
  border: 1px solid var(--line-color);
  border-radius: 3px;
  padding: 0.5em 1em 0;
  margin-bottom: 0.5em;
}
.alignCenter.art-text pre {
  padding: 0;
  width: auto;
}
.alignCenter {
  margin: 1em 0;
}
.alignCenter > *:first-child {
  border: none;
  /* this isn't optimal, but it's an existence proof.  PrinceXML doesn't
     support flexbox yet.
  */
  display: table;
  margin: 0 auto;
}

/* lists */
ol, ul {
  padding: 0;
  margin: 0 0 0.5em 2em;
}
:is(ol, ul) :is(ol, ul) {
  margin-left: 1em;
}
li {
  margin: 0 0 0.25em 0;
}
.ulCompact li {
  margin: 0;
}
ul.empty, .ulEmpty {
  list-style-type: none;
}
ul.empty li, .ulEmpty li {
  margin-top: 0.5em;
}
:is(ul, ol).compact, .ulCompact, .olCompact {
  line-height: 1;
  margin: 0 0 0 2em;
}

/* definition lists */
dl {
  clear: left;
  --indent: 3ch;
  /* --indent: attr(indent ch); not supported in any browser, but we can dream */
}
dl.olPercent {
  --indent: 5ch;
}
dl > dt {
  float: left;
  margin-right: 2ch;
  min-width: 8ch;
}
dl.dlNewline > dt {
  float: none;
}
dl > dd {
  margin-bottom: .8em;
  margin-left: var(--indent) !important; /* stupid element overrides */
  min-height: 2ex;
}
dl.olPercent > dt {
  min-width: calc(var(--indent) - 2ch);
}
:is(dl.compact, .dlCompact) > dd {
  margin-bottom: 0;
}
:is(dl.compact, .dlCompact) > dd > :is(:first-child, .break:first-child + *) {
  margin-top: 0;
}
:is(dl.compact, .dlCompact) > dd > :is(:last-child) {
  margin-bottom: 0;
}
dl > dd > dl {
  margin-top: 0.5em;
  margin-bottom: 0;
}
:is(dd, span).break {
  display: none;
}

/* links */
a, a[href].selfRef:hover {
  text-decoration: none;
}
a[href] {
  color: var(--link-color);
}
a[href].selfRef, .iref + a[href].internal {
  color: var(--text-color);
}
a[href]:hover {
  text-decoration: underline;
}
a[href].selfRef:hover {
  background-color: var(--highlight-color);
}
a.xref:is(.cite, .auto), :is(#status-of-memo, #copyright) a {
  white-space: nowrap;
}

/* Figures */
tt, code, pre {
  background-color: var(--highlight-color);
  font: 14px/22px var(--font-mono);
}
tt, code {
  /* changing the font for inline elements leads to different ascender
     and descender heights; as we want to retain baseline alignment,
     remove leading to avoid altering the final height of lines
     note: this fails if these blocks take an entire line,
     a different solution would be great */
  line-height: 0;
}
:is(h1, h2, h3, h4, h5, h6) :is(tt, code) {
  font-size: 84%;
}
pre {
  border: 1px solid var(--line-color);
  font-size: 13.5px;
  line-height: 16px;
  letter-spacing: -0.2px;
  margin: 5px;
  padding: 5px;
}
img {
  max-width: 100%;
}
figure {
  margin: 0.5em 0;
  padding: 0;
}
figure blockquote {
  margin: 0.8em 0.4em 0.4em;
}
figcaption, caption {
  font-style: italic;
  margin: 0.5em 1.5em;
  text-align: left;
}
@media screen {
  /* Auto-collapse boilerplate. */
  :is(#status-of-memo, #copyright) p {
    margin: -2px 0;
    max-height: 0;
    transition: max-height 2s ease, margin 0.5s ease 0.5s;
    overflow: hidden;
  }
  :is(#status-of-memo, #copyright):hover p,
  :is(#status-of-memo, #copyright) h2:target ~ p {
    margin: 0.5em 0;
    max-height: 500px;
    overflow: auto;
  }
  pre, svg {
    display: inline-block;
    overflow-x: auto;
  }
  pre {
    max-width: 100%;
    width: calc(100% - 22px - 1em);
  }
  svg {
    max-width: calc(100% - 22px - 1em);
  }
  figure pre {
    display: block;
    width: calc(100% - 25px);
  }
  :is(pre, svg) + .pilcrow {
    display: inline-block;
    vertical-align: text-bottom;
    padding-bottom: 8px;
  }
}

/* aside, blockquote */
aside, blockquote {
  margin-left: 0;
  padding: 0 2em;
  font-style: italic;
}
blockquote {
  margin: 1em 0;
}
cite {
  display: block;
  text-align: right;
  font-style: italic;
}

/* tables */
table {
  max-width: 100%;
  margin: 0 0 1em;
  border-collapse: collapse;
}
table.right {
  margin-left: auto;
}
table.center {
  margin-left: auto;
  margin-right: auto;
}
table.left {
  margin-right: auto;
}
thead, tbody {
  border: 1px solid var(--line-color);
}
th, td {
  text-align: left;
  vertical-align: top;
  padding: 5px 10px;
}
th {
  background-color: var(--line-color);
}
:is(tr:nth-child(2n), thead+tbody > tr:nth-child(2n+1)) > td {
  background-color: var(--background-color);
}
:is(tr:nth-child(2n+1), thead+tbody > tr:nth-child(2n)) > td {
  background-color: var(--highlight-color);
}
table caption {
  margin: 0;
  padding: 3px 0 3px 1em;
}
table p {
  margin: 0;
}

/* pilcrow */
a.pilcrow {
  margin-left: 3px;
  opacity: 0.2;
  user-select: none;
}
a.pilcrow[href] { color: var(--pilcrow-weak); }
a.pilcrow[href]:hover { text-decoration: none; }
@media not print {
  :hover > a.pilcrow {
    opacity: 1;
  }
  a.pilcrow[href]:hover {
    color: var(--pilcrow-strong);
    background-color: transparent;
  }
}
@media print {
  a.pilcrow {
    display: none;
  }
}

/* misc */
hr {
  border: 0;
  border-top: 1px solid var(--line-color);
}
.bcp14 {
  font-variant: small-caps;
  font-weight: 600;
  font-size: var(--small-font-size);
}
.role {
  font-variant: all-small-caps;
}
sub, sup {
  line-height: 1;
  font-size: 80%;
}

/* info block */
#identifiers {
  margin: 0;
  font-size: var(--small-font-size);
  line-height: 18px;
  --identifier-width: 15ch;
}
#identifiers dt {
  width: var(--identifier-width);
  min-width: var(--identifier-width);
  clear: left;
  float: left;
  text-align: right;
  margin-right: 1ch;
}
#identifiers dd {
  margin: 0;
  margin-left: calc(1em + var(--identifier-width)) !important;
  min-width: 5em;
}
#identifiers .authors .author {
  display: inline-block;
  margin-right: 1.5em;
}
#identifiers .authors .org {
  font-style: italic;
}

/* The prepared/rendered info at the very bottom of the page */
.docInfo {
  color: #999;
  font-size: 0.9em;
  font-style: italic;
  margin-top: 2em;
}
.docInfo .prepared {
  float: left;
}
.docInfo .prepared {
  float: right;
}

/* table of contents */
#toc {
  padding: 0.75em 0 2em 0;
  margin-bottom: 1em;
}
#toc nav ul {
  margin: 0 0.5em 0 0;
  padding: 0;
  list-style: none;
}
#toc nav li {
  line-height: 1.3em;
  margin: 2px 0;
  padding-left: 1.2em;
  text-indent: -1.2em;
}
#toc a.xref {
  white-space: normal;
}
/* references */
.references dt {
  text-align: right;
  font-weight: bold;
  min-width: 10ch;
  margin-right: 1.5ch;
}
.references dt:target::before {
  content: "â";
  width: 15px;
  margin: 0 10px 0 -25px;
}
.references dd {
  margin-left: 12ch !important;
  overflow: auto;
}

.refInstance {
  margin-bottom: 1.25em;
}

.references .ascii {
  margin-bottom: 0.25em;
}

/* index */
#rfc\.index\.index + ul {
  margin-left: 0;
}

/* authors */
address.vcard {
  font-style: normal;
  margin: 1em 0;
}
address.vcard .nameRole {
  font-weight: 700;
  margin-left: 0;
}
address.vcard .label {
  margin: 0.5em 0;
}
address.vcard .type {
  display: none;
}
.alternative-contact {
  margin: 1.5em 0 1em;
}
hr.addr {
  border-top: 1px dashed;
  margin: 0;
  color: #ddd;
  max-width: calc(100% - 16px);
}
@media (min-width: 500px) {
  #authors-addresses > section {
    column-count: 2;
    column-gap: 20px;
  }
  #authors-addresses > section > h2 {
    column-span: all;
  }
  /* hack for break-inside: avoid-column */
  #authors-addresses address {
    display: inline-block;
    break-inside: avoid-column;
  }
}

.rfcEditorRemove p:first-of-type {
  font-style: italic;
}
.cref {
  background-color: rgba(249, 232, 105, 0.3);
  padding: 2px 4px;
}
.crefSource {
  font-style: italic;
}
/* alternative layout for smaller screens */
@media screen and (max-width: 929px) {
  #toc {
    position: fixed;
    z-index: 2;
    top: 0;
    right: 0;
    padding: 1px 0 0 0;
    margin: 0;
    border-bottom: 1px solid #ccc;
    opacity: 0.6;
  }
  #toc.active {
      opacity: 1;
  }
  #toc h2 {
    margin: 0;
    padding: 2px 0 2px 6px;
    padding-right: 1em;
    font-size: 18px;
    line-height: 24px;
    min-width: 190px;
    text-align: right;
    background-color: #444;
    color: white;
    cursor: pointer;
  }
  #toc h2::before { /* css hamburger */
    float: right;
    position: relative;
    width: 1em;
    height: 1px;
    left: -164px;
    margin: 8px 0 0 0;
    background: white none repeat scroll 0 0;
    box-shadow: 0 4px 0 0 white, 0 8px 0 0 white;
    content: "";
  }
  #toc nav {
    display: none;
    background-color: var(--background-color);
    padding: 0.5em 1em 1em;
    overflow: auto;
    overscroll-behavior: contain;
    height: calc(100vh - 48px);
    border-left: 1px solid #ddd;
  }
  #toc.active nav {
    display: block;
  }
  /* Make the collapsed ToC header render white on gray also when it's a link */
  #toc h2 a,
  #toc h2 a:link,
  #toc h2 a:focus,
  #toc h2 a:hover,
  #toc a.toplink,
  #toc a.toplink:hover {
    color: white;
    background-color: #444;
    text-decoration: none;
  }
  #toc a.toplink {
    margin-top: 2px;
  }
}

/* alternative layout for wide screens */
@media screen and (min-width: 930px) {
  body {
    padding-right: 360px;
    padding-right: calc(min(180px + 20%, 500px));
  }
  #toc {
    position: fixed;
    bottom: 0;
    right: 0;
    right: calc(50vw - 480px);
    width: 312px;
    margin: 0;
    padding: 0;
    z-index: 1;
  }
  #toc h2 {
    margin: 0;
    padding: 0.25em 1em 1em 0;
  }
  #toc nav {
    display: block;
    height: calc(90vh - 84px);
    bottom: 0;
    padding: 0.5em 0 2em;
    overflow: auto;
    overscroll-behavior: contain;
    scrollbar-width: thin;
  }
  #toc nav > ul  {
    margin-bottom: 2em;
  }
  #toc ul {
    margin: 0 0 0 4px;
    font-size: var(--small-font-size);
  }
  #toc ul :is(p, li) {
    margin: 2px 0;
    line-height: 22px;
  }
  img { /* future proofing */
    max-width: 100%;
    height: auto;
  }
}

/* pagination */
@media print {
  body {
    width: 100%;
  }
  p {
    orphans: 3;
    widows: 3;
  }
  #n-copyright-notice {
    border-bottom: none;
  }
  #toc, #n-introduction {
    page-break-before: always;
  }
  #toc {
    border-top: none;
    padding-top: 0;
  }
  figure, pre, .vcard {
    page-break-inside: avoid;
  }
  h1, h2, h3, h4, h5, h6 {
    page-break-after: avoid;
  }
  :is(h2, h3, h4, h5, h6)+*, dd {
    page-break-before: avoid;
  }
  pre {
    white-space: pre-wrap;
    word-wrap: break-word;
    font-size: 10pt;
  }
  table {
    border: 1px solid #ddd;
  }
  td {
    border-top: 1px solid #ddd;
  }
  .toplink {
    display: none;
  }
}

@page :first {
  padding-top: 0;
  @top-left {
    content: normal;
    border: none;
  }
  @top-center {
    content: normal;
    border: none;
  }
  @top-right {
    content: normal;
    border: none;
  }
}

@page {
  size: A4;
  margin-bottom: 45mm;
  padding-top: 20px;
}

/* Changes introduced to fix issues found during implementation */

/* Separate body from document info even without intervening H1 */
section {
  clear: both;
}

/* Top align author divs, to avoid names without organization dropping level with org names */
.author {
  vertical-align: top;
}

/* Style section numbers with more space between number and title */
.section-number {
  padding-right: 0.5em;
}

/* Add styling for a link in the ToC that points to the top of the document */
a.toplink {
  float: right;
  margin: 8px 0.5em 0;
}

/* Provide styling for table cell text alignment */
table .text-left {
  text-align: left;
}
table .text-center {
  text-align: center;
}
table .text-right {
  text-align: right;
}

/* Make the alternative author contact information look less like just another
   author, and group it closer with the primary author contact information */
.alternative-contact {
  margin: 0.5em 0 0.25em 0;
}
address .non-ascii {
  margin: 0 0 0 2em;
}

/* With it being possible to set tables with alignment
  left, center, and right, { width: 100%; } does not make sense */
table {
  width: auto;
}

/* Avoid reference text that sits in a block with very wide left margin,
   because of a long floating dt label.*/
.references dd {
  overflow: visible;
}

/* Control caption placement */
caption {
  caption-side: bottom;
}

/* Limit the width of the author address vcard, so names in right-to-left
   script don't end up on the other side of the page. */

address.vcard {
  max-width: 20em;
  margin-right: auto;
}

/* For address alignment dependent on LTR or RTL scripts */
address div.left {
  text-align: left;
}
address div.right {
  text-align: right;
}

/* Dark mode. */
@media (prefers-color-scheme: dark) {
:root {
  --background-color: #121212;
  --text-color: #f0f0f0;
  --title-color: #fff;
  --link-color: #4da4f0;
  --highlight-color: #282828;
  --line-color: #444;
  --pilcrow-weak: #444;
  --pilcrow-strong: #666;
  scrollbar-color: #777 #333;
}
}

/* SVG Trick: a prefix match works because only black and white are allowed */
svg :is([stroke="black"], [stroke^="#000"]) {
  stroke: var(--text-color);
}
svg :is([stroke="white"], [stroke^="#fff"]) {
  stroke: var(--background-color);
}
svg :is([fill="black"], [fill^="#000"], :not([fill])) {
  fill: var(--text-color);
}
svg :is([fill="white"], [fill^="#fff"]) {
  fill: var(--background-color);
}
</style>

</head>
<body class="xml2rfc">
<table class="ears">
<thead><tr>
<td class="left">Internet-Draft</td>
<td class="center">Fiat-Shamir Heuristic</td>
<td class="right">April 2024</td>
</tr></thead>
<tfoot><tr>
<td class="left">OrrÃ¹</td>
<td class="center">Expires 20 October 2024</td>
<td class="right">[Page]</td>
</tr></tfoot>
</table>
<div id="external-metadata" class="document-information"></div>
<div id="internal-metadata" class="document-information">
<dl id="identifiers">
<dt class="label-workgroup">Workgroup:</dt>
<dd class="workgroup">Zkproof</dd>
<dt class="label-internet-draft">Internet-Draft:</dt>
<dd class="internet-draft">draft-orru-zkproof-fiat-shamir-latest</dd>
<dt class="label-published">Published:</dt>
<dd class="published">
<time datetime="2024-04-18" class="published">18 April 2024</time>
    </dd>
<dt class="label-intended-status">Intended Status:</dt>
<dd class="intended-status">Informational</dd>
<dt class="label-expires">Expires:</dt>
<dd class="expires"><time datetime="2024-10-20">20 October 2024</time></dd>
<dt class="label-authors">Author:</dt>
<dd class="authors">
<div class="author">
      <div class="author-name">M. OrrÃ¹</div>
<div class="org">CNRS</div>
</div>
</dd>
</dl>
</div>
<h1 id="title">Fiat-Shamir Heuristic</h1>
<section id="section-abstract">
      <h2 id="abstract"><a href="#abstract" class="selfRef">Abstract</a></h2>
<p id="section-abstract-1">This document describes the Fiat-Shamir transform.<a href="#section-abstract-1" class="pilcrow">Â¶</a></p>
</section>
<section class="note rfcEditorRemove" id="section-note.1">
      <h2 id="name-about-this-document">
<a href="#name-about-this-document" class="section-name selfRef">About This Document</a>
      </h2>
<p id="section-note.1-1">This note is to be removed before publishing as an RFC.<a href="#section-note.1-1" class="pilcrow">Â¶</a></p>
<p id="section-note.1-2">
        The latest revision of this draft can be found at <span><a href="https://mmaker.github.io/stdsigma/draft-sigma-protocols.html">https://mmaker.github.io/stdsigma/draft-sigma-protocols.html</a></span>.
        Status information for this document may be found at <span><a href="https://datatracker.ietf.org/doc/draft-orru-zkproof-fiat-shamir/">https://datatracker.ietf.org/doc/draft-orru-zkproof-fiat-shamir/</a></span>.<a href="#section-note.1-2" class="pilcrow">Â¶</a></p>
<p id="section-note.1-3">Source for this draft and an issue tracker can be found at
        <span><a href="https://github.com/mmaker/stdsigma">https://github.com/mmaker/stdsigma</a></span>.<a href="#section-note.1-3" class="pilcrow">Â¶</a></p>
</section>
<div id="status-of-memo">
<section id="section-boilerplate.1">
        <h2 id="name-status-of-this-memo">
<a href="#name-status-of-this-memo" class="section-name selfRef">Status of This Memo</a>
        </h2>
<p id="section-boilerplate.1-1">
        This Internet-Draft is submitted in full conformance with the
        provisions of BCP 78 and BCP 79.<a href="#section-boilerplate.1-1" class="pilcrow">Â¶</a></p>
<p id="section-boilerplate.1-2">
        Internet-Drafts are working documents of the Internet Engineering Task
        Force (IETF). Note that other groups may also distribute working
        documents as Internet-Drafts. The list of current Internet-Drafts is
        at <span><a href="https://datatracker.ietf.org/drafts/current/">https://datatracker.ietf.org/drafts/current/</a></span>.<a href="#section-boilerplate.1-2" class="pilcrow">Â¶</a></p>
<p id="section-boilerplate.1-3">
        Internet-Drafts are draft documents valid for a maximum of six months
        and may be updated, replaced, or obsoleted by other documents at any
        time. It is inappropriate to use Internet-Drafts as reference
        material or to cite them other than as "work in progress."<a href="#section-boilerplate.1-3" class="pilcrow">Â¶</a></p>
<p id="section-boilerplate.1-4">
        This Internet-Draft will expire on 20 October 2024.<a href="#section-boilerplate.1-4" class="pilcrow">Â¶</a></p>
</section>
</div>
<div id="copyright">
<section id="section-boilerplate.2">
        <h2 id="name-copyright-notice">
<a href="#name-copyright-notice" class="section-name selfRef">Copyright Notice</a>
        </h2>
<p id="section-boilerplate.2-1">
            Copyright (c) 2024 IETF Trust and the persons identified as the
            document authors. All rights reserved.<a href="#section-boilerplate.2-1" class="pilcrow">Â¶</a></p>
<p id="section-boilerplate.2-2">
            This document is subject to BCP 78 and the IETF Trust's Legal
            Provisions Relating to IETF Documents
            (<span><a href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a></span>) in effect on the date of
            publication of this document. Please review these documents
            carefully, as they describe your rights and restrictions with
            respect to this document. Code Components extracted from this
            document must include Revised BSD License text as described in
            Section 4.e of the Trust Legal Provisions and are provided without
            warranty as described in the Revised BSD License.<a href="#section-boilerplate.2-2" class="pilcrow">Â¶</a></p>
</section>
</div>
<div id="toc">
<section id="section-toc.1">
        <a href="#" onclick="scroll(0,0)" class="toplink">â²</a><h2 id="name-table-of-contents">
<a href="#name-table-of-contents" class="section-name selfRef">Table of Contents</a>
        </h2>
<nav class="toc"><ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1">
            <p id="section-toc.1-1.1.1"><a href="#section-1" class="auto internal xref">1</a>.Â Â <a href="#name-introduction" class="internal xref">Introduction</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.1">
                <p id="section-toc.1-1.1.2.1.1"><a href="#section-1.1" class="auto internal xref">1.1</a>.Â Â <a href="#name-syntax" class="internal xref">Syntax</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.1.2.1">
                    <p id="section-toc.1-1.1.2.1.2.1.1" class="keepWithNext"><a href="#section-1.1.1" class="auto internal xref">1.1.1</a>.Â Â <a href="#name-constants" class="internal xref">Constants</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.1.2.2">
                    <p id="section-toc.1-1.1.2.1.2.2.1" class="keepWithNext"><a href="#section-1.1.2" class="auto internal xref">1.1.2</a>.Â Â <a href="#name-hash-registry" class="internal xref">Hash Registry</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.1.2.3">
                    <p id="section-toc.1-1.1.2.1.2.3.1" class="keepWithNext"><a href="#section-1.1.3" class="auto internal xref">1.1.3</a>.Â Â <a href="#name-computing-the-challenge-and" class="internal xref">Computing the challenge and seeding the commitment</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.1.2.4">
                    <p id="section-toc.1-1.1.2.1.2.4.1"><a href="#section-1.1.4" class="auto internal xref">1.1.4</a>.Â Â <a href="#name-non-interactive-proofs" class="internal xref">Non-interactive proofs</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.1.2.5">
                    <p id="section-toc.1-1.1.2.1.2.5.1"><a href="#section-1.1.5" class="auto internal xref">1.1.5</a>.Â Â <a href="#name-batchable-proofs" class="internal xref">Batchable Proofs</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.1.2.6">
                    <p id="section-toc.1-1.1.2.1.2.6.1"><a href="#section-1.1.6" class="auto internal xref">1.1.6</a>.Â Â <a href="#name-short-proofs" class="internal xref">Short Proofs</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.2">
                <p id="section-toc.1-1.1.2.2.1"><a href="#section-1.2" class="auto internal xref">1.2</a>.Â Â <a href="#name-input-validation" class="internal xref">Input validation</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2">
            <p id="section-toc.1-1.2.1"><a href="#section-2" class="auto internal xref">2</a>.Â Â <a href="#name-introduction-2" class="internal xref">Introduction</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3">
            <p id="section-toc.1-1.3.1"><a href="#section-3" class="auto internal xref">3</a>.Â Â <a href="#name-technical-overview" class="internal xref">Technical Overview</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4">
            <p id="section-toc.1-1.4.1"><a href="#section-4" class="auto internal xref">4</a>.Â Â <a href="#name-io-pattern" class="internal xref">IO Pattern</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5">
            <p id="section-toc.1-1.5.1"><a href="#section-5" class="auto internal xref">5</a>.Â Â <a href="#name-duplex-hash" class="internal xref">Duplex Hash</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6">
            <p id="section-toc.1-1.6.1"><a href="#section-6" class="auto internal xref">6</a>.Â Â <a href="#name-pover-state" class="internal xref">Pover state</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7">
            <p id="section-toc.1-1.7.1"><a href="#section-7" class="auto internal xref">7</a>.Â Â <a href="#name-serialization-and-conversio" class="internal xref">Serialization and conversion of Elements</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8">
            <p id="section-toc.1-1.8.1"><a href="#section-8" class="auto internal xref">8</a>.Â Â <a href="#name-additional-material" class="internal xref">Additional Material</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9">
            <p id="section-toc.1-1.9.1"><a href="#appendix-A" class="auto internal xref"></a><a href="#name-authors-address" class="internal xref">Author's Address</a></p>
</li>
        </ul>
</nav>
</section>
</div>
<div id="sec_fs">
<section id="section-1">
      <h2 id="name-introduction">
<a href="#section-1" class="section-number selfRef">1. </a><a href="#name-introduction" class="section-name selfRef">Introduction</a>
      </h2>
<p id="section-1-1">The interactive versions of the Sigma protocols presented in this
document are not fit for practical applications, due to subtle yet
impactful details in their security guarantees. In practice, public-coin
protocols such as Sigma protocols can be converted into
non-interactive ones through the Fiat and Shamir heuristicÂ [@C:FiaSha86]
and subsequent work, e.g., by Bernhard, Pereira and
WarinschiÂ [@AC:BerPerWar12].<a href="#section-1-1" class="pilcrow">Â¶</a></p>
<p id="section-1-2">The underlying idea is to replace the verifier with a cryptographically
secure hash function, hashing the context from the protocol and the
previous message sent by the prover.<a href="#section-1-2" class="pilcrow">Â¶</a></p>
<p id="section-1-3">::: warning
Interactive Sigma protocols illustrated in this
spec <strong>must not</strong> be used interactively.
:::<a href="#section-1-3" class="pilcrow">Â¶</a></p>
<div id="syntax">
<section id="section-1.1">
        <h3 id="name-syntax">
<a href="#section-1.1" class="section-number selfRef">1.1. </a><a href="#name-syntax" class="section-name selfRef">Syntax</a>
        </h3>
<p id="section-1.1-1">When using a hash function we will employ comma-separated values to
indicate values that are concatenated. To mitigate attacks and allow for
state cloning, we also separate values with semi-colons to indicate that
they must appear in a subsequent block and that the previous is padded
with zeros. For instance, with the writing
$\hash(a \,\textbf{,}~b \,\mathbf{\mid}~c)$ we denote the hashing of $a$
concatenated to $b$, then padded with the null byte until to reach the
closest multiple of <code>BLOCK_LEN</code> bytes added, then and
concatenate the resulting bit string to $c$.<a href="#section-1.1-1" class="pilcrow">Â¶</a></p>
<div id="constants">
<section id="section-1.1.1">
          <h4 id="name-constants">
<a href="#section-1.1.1" class="section-number selfRef">1.1.1. </a><a href="#name-constants" class="section-name selfRef">Constants</a>
          </h4>
<p id="section-1.1.1-1">Different hash functions may rely on different constants. We define some
of the parameters associated to the hash function that will be used
throughout this spec.<a href="#section-1.1.1-1" class="pilcrow">Â¶</a></p>
<p id="section-1.1.1-2">::: center
         Const name        Notes
  ------------------------ -------------------------------------------------------------------------------------------------------------
     <code>DOMSEP}$     Domain separator for this standard. Fixed to $\texttt{\textquotesingle{}zkpstd/sigma/0.1\textquotesingle</code>.
   <code>BLOCK_LEN</code>   Length of a hash block
   <code>DIGEST_LEN</code>  Digest length
:::<a href="#section-1.1.1-2" class="pilcrow">Â¶</a></p>
</section>
</div>
<div id="sec_hash-registry">
<section id="section-1.1.2">
          <h4 id="name-hash-registry">
<a href="#section-1.1.2" class="section-number selfRef">1.1.2. </a><a href="#name-hash-registry" class="section-name selfRef">Hash Registry</a>
          </h4>
<p id="section-1.1.2-1">This is the set of all supported hash functions. They take an arbitrary
length sequence of bytes as input, and output
32 bytes of entropy.<a href="#section-1.1.2-1" class="pilcrow">Â¶</a></p>
<p id="section-1.1.2-2">::: center
  Hash       Source           <code>BLOCK_LEN}$    $\texttt{DIGEST_LEN</code>
  ---------- ---------------- ----------------------- ------------------------ --
  blake2b    [@ACNS:ANWW13]   128                                64
  sha3-256   [@EC:BDPA13]     136                                32
:::<a href="#section-1.1.2-2" class="pilcrow">Â¶</a></p>
<p id="section-1.1.2-3">Supported hash functions must all have $<code>BLOCK_LEN</code>\geq 32$. We
define labels and constant strings so that their length is always at
most 32 bytes. If $<code>DIGEST_LEN</code>\ge 32$, we
implicitly assume that the implementation considers only the least
significant bytes and discards the remainder of the hash output when
exactly 32 bytes bytes are needed.<a href="#section-1.1.2-3" class="pilcrow">Â¶</a></p>
</section>
</div>
<div id="sec_fs-challenge">
<section id="section-1.1.3">
          <h4 id="name-computing-the-challenge-and">
<a href="#section-1.1.3" class="section-number selfRef">1.1.3. </a><a href="#name-computing-the-challenge-and" class="section-name selfRef">Computing the challenge and seeding the commitment</a>
          </h4>
<p id="section-1.1.3-1">Relying on a hash function allows us to both compute the challenge and
generate the commitment securely. We define the following auxiliary
variables that may be pre-computed during the call of
$<code>SigmaProtocol</code>.<code>new</code>(<code>ctx</code>, Y)$. All variables
will have fixed length <code>DIGEST_LEN</code> so to avoid
canonicalization attacks.<a href="#section-1.1.3-1" class="pilcrow">Â¶</a></p>
<div id="seeding-the-commitment">
<section id="section-1.1.3.1">
            <h5 id="name-seeding-the-commitment">
<a href="#section-1.1.3.1" class="section-number selfRef">1.1.3.1. </a><a href="#name-seeding-the-commitment" class="section-name selfRef">Seeding the commitment</a>
            </h5>
<p id="section-1.1.3.1-1">The method $<code>SigmaProtocol</code>.<code>prover_commit</code>()$ is a
randomized function that generates a random element, unique per each
execution. The commitment <em>should</em> be seeded as follows:<a href="#section-1.1.3.1-1" class="pilcrow">Â¶</a></p>
<p id="section-1.1.3.1-2">If the output length <code>DIGEST_LEN</code> of the
hash function is not sufficient to provide enough entropy for the
commitment, the seed may be expanded with a PRNG to provide the quantity
of random bytes desired.<a href="#section-1.1.3.1-2" class="pilcrow">Â¶</a></p>
</section>
</div>
<div id="computing-the-challenge">
<section id="section-1.1.3.2">
            <h5 id="name-computing-the-challenge">
<a href="#section-1.1.3.2" class="section-number selfRef">1.1.3.2. </a><a href="#name-computing-the-challenge" class="section-name selfRef">Computing the challenge</a>
            </h5>
<p id="section-1.1.3.2-1">The method $<code>SigmaProtocol</code>.<code>challenge</code>(\mu, T)$ is
implemented as follows in order to produce a random challenge.<a href="#section-1.1.3.2-1" class="pilcrow">Â¶</a></p>
<p id="section-1.1.3.2-2">If no message is being set, i.e. if $\mu= \mathsf{None}$, then the
implementation may decide to skip the computation of $\text{hm}$ and
consider it empty. This method is fixed for all implementations of
<code>SigmaProtocol</code>. Note that the state of the hash function is
partially shared between the commitment seed inputs and the challenge
computation. Implementors may choose to store the partial hash state
before generating the commitment, and reuse it when computing the
challenge.<a href="#section-1.1.3.2-2" class="pilcrow">Â¶</a></p>
</section>
</div>
</section>
</div>
<div id="non-interactive-proofs">
<section id="section-1.1.4">
          <h4 id="name-non-interactive-proofs">
<a href="#section-1.1.4" class="section-number selfRef">1.1.4. </a><a href="#name-non-interactive-proofs" class="section-name selfRef">Non-interactive proofs</a>
          </h4>
<p id="section-1.1.4-1">We define two <em>public methods</em> for generating proofs, meant to be
exposed externally: <code>short_proof</code>, and
<code>batchable_proof</code>. Since the challenge is computed
deterministically from the commitment and the statement, it is not
necessary to include the full transcript in a proof, as it can be
deduced in the verification phase.<a href="#section-1.1.4-1" class="pilcrow">Â¶</a></p>
<p id="section-1.1.4-2">Short proofs are the most efficient if the protocol contains at least an
<em>AND</em> composition, and the gain in size
is measured as $|\mathbf T| - <code>DIGEST_LEN</code>$. (Note: the length
of the commitment is the length of the statement.) Batchable proofs are
the canonical forms of proofs. Provers in the batchable form may raise
an exception if the statement is not valid. Proofs are seen as
fixed-length bit strings, whose exact length can be inferred from the
statement during initialization of the Sigma protocol.<a href="#section-1.1.4-2" class="pilcrow">Â¶</a></p>
<p id="section-1.1.4-3">::: remark
Witness validation In the following we assume correctness of the witness
$w$ for the given statement $Y$. This can be ensured, e.g., by a
higher-level application, or by running
$<code>SigmaProtocol</code>.<code>verifier</code>(T, c, s)$ before sending the
resulting proof.
:::<a href="#section-1.1.4-3" class="pilcrow">Â¶</a></p>
</section>
</div>
<div id="batchable-proofs">
<section id="section-1.1.5">
          <h4 id="name-batchable-proofs">
<a href="#section-1.1.5" class="section-number selfRef">1.1.5. </a><a href="#name-batchable-proofs" class="section-name selfRef">Batchable Proofs</a>
          </h4>
<span class="break"></span><dl class="dlParallel" id="section-1.1.5-1">
            <dt id="section-1.1.5-1.1">Prover algorithm.</dt>
            <dd style="margin-left: 1.5em" id="section-1.1.5-1.2">
              <p id="section-1.1.5-1.2.1">The public function
$<code>SigmaProtocol</code>.<code>batchable_proof</code>( w, \mu)$
computes:<a href="#section-1.1.5-1.2.1" class="pilcrow">Â¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-1.1.5-1.2.2">
<li id="section-1.1.5-1.2.2.1">
                  <p id="section-1.1.5-1.2.2.1.1">$(T,<code>pstate</code>)\gets<code>SigmaProtocol</code>.<code>prover_commit</code>( w)$.<a href="#section-1.1.5-1.2.2.1.1" class="pilcrow">Â¶</a></p>
</li>
                <li id="section-1.1.5-1.2.2.2">
                  <p id="section-1.1.5-1.2.2.2.1">$c \gets <code>SigmaProtocol</code>.<code>challenge</code>(\mu,T)$<a href="#section-1.1.5-1.2.2.2.1" class="pilcrow">Â¶</a></p>
</li>
                <li id="section-1.1.5-1.2.2.3">
                  <p id="section-1.1.5-1.2.2.3.1">$s\gets<code>SigmaProtocol</code>.<code>prover_response</code>(<code>pstate</code>,  c)$.
Return $<code>Serialize</code>(T)$ concatenated to
$<code>Serialize</code>(\mathbf s)$<a href="#section-1.1.5-1.2.2.3.1" class="pilcrow">Â¶</a></p>
</li>
              </ol>
<p id="section-1.1.5-1.2.3">The challenge $c$ is not provided within a batchable proof since it
can be re-computed from the commitment.<a href="#section-1.1.5-1.2.3" class="pilcrow">Â¶</a></p>
</dd>
            <dd class="break"></dd>
<dt id="section-1.1.5-1.3">Verifier algorithm.</dt>
            <dd style="margin-left: 1.5em" id="section-1.1.5-1.4">
              <p id="section-1.1.5-1.4.1">The verifier's algorithm
$<code>SigmaProtocol</code>.<code>batchable_verify</code>(\pi, \mu)$ works
as follows:<a href="#section-1.1.5-1.4.1" class="pilcrow">Â¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-1.1.5-1.4.2">
<li id="section-1.1.5-1.4.2.1">
                  <p id="section-1.1.5-1.4.2.1.1">$(T,s) \coloneqq<code>Deserialize</code>(\pi)$<a href="#section-1.1.5-1.4.2.1.1" class="pilcrow">Â¶</a></p>
</li>
                <li id="section-1.1.5-1.4.2.2">
                  <p id="section-1.1.5-1.4.2.2.1">$c \gets <code>SigmaProtocol</code>.<code>challenge</code>(\mu, T)$<a href="#section-1.1.5-1.4.2.2.1" class="pilcrow">Â¶</a></p>
</li>
                <li id="section-1.1.5-1.4.2.3">
                  <p id="section-1.1.5-1.4.2.3.1">Return whatever
$<code>SigmaProtocol</code>.<code>verifier</code>(T,c, s)$ returns.<a href="#section-1.1.5-1.4.2.3.1" class="pilcrow">Â¶</a></p>
</li>
              </ol>
<p id="section-1.1.5-1.4.3">::: warning
Input validation The case of batched verification must include an
input validation sub-routine that asserts the statement and
commitments are in question. In the case of elliptic curves, this boils down to point
validation. Failure to properly check that a commitment is in the
group could lead to subgroup attacksÂ [@EC:VanWie96; @C:LimLee97] or
invalid curve attacksÂ [@C:BieMeyMul00; @RSA:BBPV12].
:::<a href="#section-1.1.5-1.4.3" class="pilcrow">Â¶</a></p>
</dd>
          <dd class="break"></dd>
</dl>
</section>
</div>
<div id="sec_shortproof">
<section id="section-1.1.6">
          <h4 id="name-short-proofs">
<a href="#section-1.1.6" class="section-number selfRef">1.1.6. </a><a href="#name-short-proofs" class="section-name selfRef">Short Proofs</a>
          </h4>
<span class="break"></span><dl class="dlParallel" id="section-1.1.6-1">
            <dt id="section-1.1.6-1.1">Prover algorithm.</dt>
            <dd style="margin-left: 1.5em" id="section-1.1.6-1.2">
              <p id="section-1.1.6-1.2.1">A new proof $<code>SigmaProtocol</code>.<code>short_proof</code>(w, \mu)$
is built as follows:<a href="#section-1.1.6-1.2.1" class="pilcrow">Â¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-1.1.6-1.2.2">
<li id="section-1.1.6-1.2.2.1">
                  <p id="section-1.1.6-1.2.2.1.1">$(T,<code>pstate</code>)\gets<code>SigmaProtocol</code>.<code>prover_commit</code>(w)$.<a href="#section-1.1.6-1.2.2.1.1" class="pilcrow">Â¶</a></p>
</li>
                <li id="section-1.1.6-1.2.2.2">
                  <p id="section-1.1.6-1.2.2.2.1">$c \gets <code>SigmaProtocol</code>.<code>challenge</code>(\mu,  T)$<a href="#section-1.1.6-1.2.2.2.1" class="pilcrow">Â¶</a></p>
</li>
                <li id="section-1.1.6-1.2.2.3">
                  <p id="section-1.1.6-1.2.2.3.1">$\mathbf s\gets<code>SigmaProtocol</code>.<code>prover_response</code>(<code>pstate</code>,c)$.<a href="#section-1.1.6-1.2.2.3.1" class="pilcrow">Â¶</a></p>
</li>
                <li id="section-1.1.6-1.2.2.4">
                  <p id="section-1.1.6-1.2.2.4.1">Return $<code>Serialize</code>(c)$ concatenated to
$<code>Serialize</code>(s)$.<a href="#section-1.1.6-1.2.2.4.1" class="pilcrow">Â¶</a></p>
</li>
              </ol>
<p id="section-1.1.6-1.2.3">The commitment $T$ is not provided within a short proof since it can
be calculated again.<a href="#section-1.1.6-1.2.3" class="pilcrow">Â¶</a></p>
</dd>
            <dd class="break"></dd>
<dt id="section-1.1.6-1.3">Verifier algorithm.</dt>
            <dd style="margin-left: 1.5em" id="section-1.1.6-1.4">
              <p id="section-1.1.6-1.4.1">The verifier's algorithm
$<code>SigmaProtocol</code>.<code>short_verify</code>(\pi, \mu)$ works as
follows:<a href="#section-1.1.6-1.4.1" class="pilcrow">Â¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-1.1.6-1.4.2">
<li id="section-1.1.6-1.4.2.1">
                  <p id="section-1.1.6-1.4.2.1.1">$(c, s) \coloneqq<code>Deserialize</code>(\pi)$<a href="#section-1.1.6-1.4.2.1.1" class="pilcrow">Â¶</a></p>
</li>
                <li id="section-1.1.6-1.4.2.2">
                  <p id="section-1.1.6-1.4.2.2.1">$T\gets <code>SigmaProtocol</code>.<code>simulate_commitment</code>(c, s)\,.$<a href="#section-1.1.6-1.4.2.2.1" class="pilcrow">Â¶</a></p>
</li>
                <li id="section-1.1.6-1.4.2.3">
                  <p id="section-1.1.6-1.4.2.3.1">$c^* \gets <code>SigmaProtocol</code>.<code>challenge</code>(\mu, T)$<a href="#section-1.1.6-1.4.2.3.1" class="pilcrow">Â¶</a></p>
</li>
                <li id="section-1.1.6-1.4.2.4">
                  <p id="section-1.1.6-1.4.2.4.1">Check whether $c=c^*$. Output $\pctrue$ if this is the case, and
$\pcfalse$ otherwise.<a href="#section-1.1.6-1.4.2.4.1" class="pilcrow">Â¶</a></p>
</li>
              </ol>
</dd>
          <dd class="break"></dd>
</dl>
<p id="section-1.1.6-2">If input parsing fails, an exception should be raised. If verification
fails, an exception should be raised. Otherwise, the verifier outputs
$\pctrue$. Optionally, the implementation can choose to return the
parsed statement.<a href="#section-1.1.6-2" class="pilcrow">Â¶</a></p>
<p id="section-1.1.6-3">::: remark
Availability of the short form While the short form as described here is
applicable to all Sigma protocols currently covered by this document,
it cannot be used for protocols where $T$ is not uniquely determined by
$c$ and $s$, as is the case, e.g., for ZKBooÂ [@USENIX:GiaMadOrl16],
one-out-of-many proofsÂ [@EC:GroKoh15], or protocols, where a randomized
signature is sent and proven correct subsequently, e.g.,
[@RSA:PoiSan16; @AC:CamChaShe08].<a href="#section-1.1.6-3" class="pilcrow">Â¶</a></p>
<p id="section-1.1.6-4">A trade-off is presented, e.g., by Bobolz et al.Â [@EPRINT:BEHF21],
requiring an additional algorithm to shorten a full transcript to a
compressed form which still allows for unique reconstruction of the
transcript.
:::<a href="#section-1.1.6-4" class="pilcrow">Â¶</a></p>
</section>
</div>
</section>
</div>
<div id="input-validation">
<section id="section-1.2">
        <h3 id="name-input-validation">
<a href="#section-1.2" class="section-number selfRef">1.2. </a><a href="#name-input-validation" class="section-name selfRef">Input validation</a>
      </h3>
</section>
</div>
</section>
</div>
<div id="introduction">
<section id="section-2">
      <h2 id="name-introduction-2">
<a href="#section-2" class="section-number selfRef">2. </a><a href="#name-introduction-2" class="section-name selfRef">Introduction</a>
      </h2>
<p id="section-2-1">We show how to perform Fiat-Shamir on any public-coin protocol,
providing randomness for the prover and secure generation of random
coins for the verifier. Informally, a non-interactive zero-knowledge
proof constructed via the Fiat-Shamir heuristic, the verifier (random
oracle) is replaced with a duplex sponge. Messages from the prover are
treated as ABSORB calls, while challenges are treated as SQUEEZE calls.
We will see this in detail below. Core features are:<a href="#section-2-1" class="pilcrow">Â¶</a></p>
<ul class="normal">
<li class="normal" id="section-2-2.1">
          <p id="section-2-2.1.1">Support custom hash function, including algebraic hashes in a
unified generic way.<a href="#section-2-2.1.1" class="pilcrow">Â¶</a></p>
</li>
        <li class="normal" id="section-2-2.2">
          <p id="section-2-2.2.1">Retro-compatibility with the NIST API.<a href="#section-2-2.2.1" class="pilcrow">Â¶</a></p>
</li>
        <li class="normal" id="section-2-2.3">
          <p id="section-2-2.3.1">Efficiency: minimizing the number of hash invocations while
maintaining security, and (whenever possible) preprocessing
information that is public or carried across protocols.<a href="#section-2-2.3.1" class="pilcrow">Â¶</a></p>
</li>
        <li class="normal" id="section-2-2.4">
          <p id="section-2-2.4.1">Private randomness generation.<a href="#section-2-2.4.1" class="pilcrow">Â¶</a></p>
</li>
        <li class="normal" id="section-2-2.5">
          <p id="section-2-2.5.1">The API makes it impossible to provide two different challenges for
the same prover message. The prover's zk randomness is bound to the
protocol transcript, without making the proof deterministic.<a href="#section-2-2.5.1" class="pilcrow">Â¶</a></p>
</li>
      </ul>
</section>
</div>
<div id="technical-overview">
<section id="section-3">
      <h2 id="name-technical-overview">
<a href="#section-3" class="section-number selfRef">3. </a><a href="#name-technical-overview" class="section-name selfRef">Technical Overview</a>
      </h2>
<p id="section-3-1">The protocol consists in:<a href="#section-3-1" class="pilcrow">Â¶</a></p>
<ul class="normal">
<li class="normal" id="section-3-2.1">
          <p id="section-3-2.1.1">Generating a string encoding the sequence of input and output
lengths (the IO pattern)<a href="#section-3-2.1.1" class="pilcrow">Â¶</a></p>
</li>
        <li class="normal" id="section-3-2.2">
          <p id="section-3-2.2.1">An API absorbing and squeezing native elements (Arthur) that is
initialized from the IO Pattern<a href="#section-3-2.2.1" class="pilcrow">Â¶</a></p>
</li>
        <li class="normal" id="section-3-2.3">
          <p id="section-3-2.3.1">An API for generating private randomness securely (Merlin) that
internally uses Arthur<a href="#section-3-2.3.1" class="pilcrow">Â¶</a></p>
</li>
      </ul>
</section>
</div>
<div id="io-pattern">
<section id="section-4">
      <h2 id="name-io-pattern">
<a href="#section-4" class="section-number selfRef">4. </a><a href="#name-io-pattern" class="section-name selfRef">IO Pattern</a>
      </h2>
<p id="section-4-1">An IO pattern is a utf8-encoded string that specifies
the protocol in a simple, non-ambiguous, human-readable format. A
typical example is the following:<a href="#section-4-1" class="pilcrow">Â¶</a></p>
<p id="section-4-2">domain-separator A32generator A32public-key R A32commitment S32challenge
A32response<a href="#section-4-2" class="pilcrow">Â¶</a></p>
<p id="section-4-3">The domain-separator is a user-specified string uniquely identifying the
end-user application (to avoid cross-protocol attacks).<a href="#section-4-3" class="pilcrow">Â¶</a></p>
<p id="section-4-4">The letter A indicates the absorption of a public input (an ABSORB),
while the letter S indicates the squeezing (a SQUEEZE) of a challenge.
The letter R indicates a ratcheting operation: ratcheting means invoking
the hash function even on an incomplete block. It provides forward
secrecy and allows it to start from a clean rate.<a href="#section-4-4" class="pilcrow">Â¶</a></p>
<p id="section-4-5">After the operation type, is the number of elements in base 10 that are
being absorbed/squeezed.<a href="#section-4-5" class="pilcrow">Â¶</a></p>
<p id="section-4-6">Then, follows the label associated with the element being
absorbed/squeezed. This often comes from the underlying description of
the protocol. The label cannot start with a digit or contain the NULL
byte.<a href="#section-4-6" class="pilcrow">Â¶</a></p>
<p id="section-4-7">Each operation is separated by the NULL byte.<a href="#section-4-7" class="pilcrow">Â¶</a></p>
<p id="section-4-8">The IO pattern string can be parsed as a queue of the form (Operation,
Length), where consecutive Operations must be merged into one adding the
length, and the length of ratchet operations is conventionally set to 0.
The IO pattern above translated to the queue:<a href="#section-4-8" class="pilcrow">Â¶</a></p>
<p id="section-4-9">(A, 64) (R, 0) (A, 32) (S, 32) (A, 32)<a href="#section-4-9" class="pilcrow">Â¶</a></p>
</section>
</div>
<div id="duplex-hash">
<section id="section-5">
      <h2 id="name-duplex-hash">
<a href="#section-5" class="section-number selfRef">5. </a><a href="#name-duplex-hash" class="section-name selfRef">Duplex Hash</a>
      </h2>
<p id="section-5-1">In addition to the IO pattern, the protocol must also
designate a hash function.<a href="#section-5-1" class="pilcrow">Â¶</a></p>
<p id="section-5-2">We focus here on permutation functions, but already dispose of a generic
bridging interface for the NIST API that we omit for now here. Fix a
permutation function P (a valid choice here is keccak-f[1600]) acting
on on R+C elements (called <em>native elements</em>), where R is called <em>rate</em>
(for keccak-f[1600] this would be R=136), and C is the capacity (for
keccak-f[1600] this would be C=64).<a href="#section-5-2" class="pilcrow">Â¶</a></p>
<p id="section-5-3">More specifically, we build a <a href="https://en.wikipedia.org/wiki/Sponge_function#Overwrite_mode">[duplex sponge in overwrite
mode]{.underline}</a>
placing the rate in the least significant indices. Note that this
definition is generic over bytes or arbitrary fields and that the
definition below is tail-recursive, and State is a mutable reference to
the hash state.<a href="#section-5-3" class="pilcrow">Â¶</a></p>
<ul class="normal">
<li class="normal" id="section-5-4.1">
          <p id="section-5-4.1.1">START(IV) -&gt; State<a href="#section-5-4.1.1" class="pilcrow">Â¶</a></p>
</li>
      </ul>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-5-5.1">
          <p id="section-5-5.1.1">[IV is assumed to be 32 bytes]<a href="#section-5-5.1.1" class="pilcrow">Â¶</a></p>
<p id="section-5-5.1.2">Create an array State of size C + R.<a href="#section-5-5.1.2" class="pilcrow">Â¶</a></p>
<p id="section-5-5.1.3">Write IV in the capacity part (indices R..R+C) of the state.
Initialize squeeze_pos=absorb_pos=0<a href="#section-5-5.1.3" class="pilcrow">Â¶</a></p>
</li>
      </ul>
<ul class="normal">
<li class="normal" id="section-5-6.1">
          <p id="section-5-6.1.1">ABSORB(State, Input[])<a href="#section-5-6.1.1" class="pilcrow">Â¶</a></p>
</li>
      </ul>
<p id="section-5-7">If Input is empty, set squeeze_pos=R<a href="#section-5-7" class="pilcrow">Â¶</a></p>
<p id="section-5-8">If absorb_pos==R, let State=P(state); set absorb_pos=0 and run
ABSORB(State, Input[]).<a href="#section-5-8" class="pilcrow">Â¶</a></p>
<p id="section-5-9">Else, State[absorb_pos]=Input[0]; absorb_pos+=1, recursively run
ABSORB(State, Input[1..]).<a href="#section-5-9" class="pilcrow">Â¶</a></p>
<ul class="normal">
<li class="normal" id="section-5-10.1">
          <p id="section-5-10.1.1">SQUEEZE(State, Output[])<a href="#section-5-10.1.1" class="pilcrow">Â¶</a></p>
</li>
      </ul>
<p id="section-5-11">If squeeze_pos==R, let State=P(State); set absorb_pos=0 and run
SQUEEZE(State, Output[]).<a href="#section-5-11" class="pilcrow">Â¶</a></p>
<p id="section-5-12">Else, Output[0]=State[squeeze_pos]; squeeze_pos+=1, recursively run
SQUEEZE(State, Output[1..])<a href="#section-5-12" class="pilcrow">Â¶</a></p>
<ul class="normal">
<li class="normal" id="section-5-13.1">
          <p id="section-5-13.1.1">RATCHET(State)<a href="#section-5-13.1.1" class="pilcrow">Â¶</a></p>
</li>
      </ul>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-5-14.1">
          <p id="section-5-14.1.1">Permute the state: State = P(State); zero the rate part of the state
State[..R] = 0, set the counters squeeze_pos=absorb_pos=0.<a href="#section-5-14.1.1" class="pilcrow">Â¶</a></p>
</li>
      </ul>
<ul class="normal">
<li class="normal" id="section-5-15.1">
          <p id="section-5-15.1.1">FINISH(State)<a href="#section-5-15.1.1" class="pilcrow">Â¶</a></p>
</li>
      </ul>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-5-16.1">
          <p id="section-5-16.1.1">Safely delete State<a href="#section-5-16.1.1" class="pilcrow">Â¶</a></p>
</li>
      </ul>
</section>
</div>
<div id="pover-state">
<section id="section-6">
      <h2 id="name-pover-state">
<a href="#section-6" class="section-number selfRef">6. </a><a href="#name-pover-state" class="section-name selfRef">Pover state</a>
      </h2>
<p id="section-6-1">The API for generating non-interactive zero-knowledge proofs using
the Fiat-Shamir transform as bytes.<a href="#section-6-1" class="pilcrow">Â¶</a></p>
<p id="section-6-2">The prover state consists of a public sponge denoted StatePub
(generating the public randomness) and a duplex hash (generating the
private instance) denoted StatePriv.<a href="#section-6-2" class="pilcrow">Â¶</a></p>
<ul class="normal">
<li class="normal" id="section-6-3.1">
          <p id="section-6-3.1.1">START(IO) -&gt; State<a href="#section-6-3.1.1" class="pilcrow">Â¶</a></p>
</li>
      </ul>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-6-4.1">
          <p id="section-6-4.1.1">Store the IO Pattern as a queue.<a href="#section-6-4.1.1" class="pilcrow">Â¶</a></p>
<p id="section-6-4.1.2">Hash the IO pattern IO into 32 bytes (ABSORB and SQUEEZE); use the
result to initialize a duplex hash StatePub.<a href="#section-6-4.1.2" class="pilcrow">Â¶</a></p>
</li>
      </ul>
<p id="section-6-5">Start a new duplex hash <em>for bytes</em>, absorbing IO as input StatePriv.<a href="#section-6-5" class="pilcrow">Â¶</a></p>
<p id="section-6-6">Initialize a byte vector Transcript.<a href="#section-6-6" class="pilcrow">Â¶</a></p>
<p id="section-6-7">Return State = (StatePub, StatePriv, Transcript)<a href="#section-6-7" class="pilcrow">Â¶</a></p>
<ul class="normal">
<li class="normal" id="section-6-8.1">
          <p id="section-6-8.1.1">ABSORB(State, Input[])<a href="#section-6-8.1.1" class="pilcrow">Â¶</a></p>
</li>
      </ul>
<p id="section-6-9">Run ABSORB_PUB(State, Input[])<a href="#section-6-9" class="pilcrow">Â¶</a></p>
<p id="section-6-10">Append ByteInput into Transcript.<a href="#section-6-10" class="pilcrow">Â¶</a></p>
<ul class="normal">
<li class="normal" id="section-6-11.1">
          <p id="section-6-11.1.1">SQUEEZE(State, Output[])<a href="#section-6-11.1.1" class="pilcrow">Â¶</a></p>
</li>
      </ul>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-6-12.1">
          <p id="section-6-12.1.1">Pop (or decrease) the head of the queue, throwing an error if
Operation is not S or Length&lt;0.<a href="#section-6-12.1.1" class="pilcrow">Â¶</a></p>
<p id="section-6-12.1.2">Squeeze Output[] elements from StatePub.<a href="#section-6-12.1.2" class="pilcrow">Â¶</a></p>
</li>
      </ul>
<ul class="normal">
<li class="normal" id="section-6-13.1">
          <p id="section-6-13.1.1">RATCHET(State)<a href="#section-6-13.1.1" class="pilcrow">Â¶</a></p>
</li>
      </ul>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-6-14.1">
          <p id="section-6-14.1.1">Pop the head of the queue, throwing an error if Operation is not R.<a href="#section-6-14.1.1" class="pilcrow">Â¶</a></p>
<p id="section-6-14.1.2">Run RATCHET(StatePub); RATCHET(StatePriv)<a href="#section-6-14.1.2" class="pilcrow">Â¶</a></p>
</li>
      </ul>
<ul class="normal">
<li class="normal" id="section-6-15.1">
          <p id="section-6-15.1.1">FINISH(State)<a href="#section-6-15.1.1" class="pilcrow">Â¶</a></p>
</li>
      </ul>
<p id="section-6-16">Throw an error if the queue is not empty.<a href="#section-6-16" class="pilcrow">Â¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-6-17.1">
          <p id="section-6-17.1.1">Run FINISH(StatePub); FINISH(StatePriv).<a href="#section-6-17.1.1" class="pilcrow">Â¶</a></p>
<p id="section-6-17.1.2">Return Transcript<a href="#section-6-17.1.2" class="pilcrow">Â¶</a></p>
</li>
      </ul>
<ul class="normal">
<li class="normal" id="section-6-18.1">
          <p id="section-6-18.1.1">ABSORB_PUBLIC(State, Input[]) -&gt; ByteInput<a href="#section-6-18.1.1" class="pilcrow">Â¶</a></p>
</li>
      </ul>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-6-19.1">
          <p id="section-6-19.1.1">[this procedure is useful for absorbing public information known
<em>outside</em> of the protocol, like the curve parameters]<a href="#section-6-19.1.1" class="pilcrow">Â¶</a></p>
<p id="section-6-19.1.2">Pop (or decrease) the head of the queue, throwing an error if
Operation is not A or Length&lt;0.<a href="#section-6-19.1.2" class="pilcrow">Â¶</a></p>
</li>
      </ul>
<p id="section-6-20">Serialize Input[] into bytes into a byte vector ByteInput.<a href="#section-6-20" class="pilcrow">Â¶</a></p>
<p id="section-6-21">Absorb Input[] into StatePub.<a href="#section-6-21" class="pilcrow">Â¶</a></p>
<p id="section-6-22">Return ByteInput.<a href="#section-6-22" class="pilcrow">Â¶</a></p>
<ul class="normal">
<li class="normal" id="section-6-23.1">
          <p id="section-6-23.1.1">ABSORB_PRIVATE(State, ByteInput[])<a href="#section-6-23.1.1" class="pilcrow">Â¶</a></p>
</li>
      </ul>
<p id="section-6-24">[this procedure is useful for adding entropy to the prover, e.g.
hashing also the witness.]<a href="#section-6-24" class="pilcrow">Â¶</a></p>
<p id="section-6-25">Absorb ByteInput[] into StatePriv. Run RATCHET(State)<a href="#section-6-25" class="pilcrow">Â¶</a></p>
<ul class="normal">
<li class="normal" id="section-6-26.1">
          <p id="section-6-26.1.1">SQUEEZE_PRIVATE(State, N) -&gt; OutputBytes[N]<a href="#section-6-26.1.1" class="pilcrow">Â¶</a></p>
</li>
      </ul>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-6-27.1">
          <p id="section-6-27.1.1">Let Seed be 32 bytes from the operating system randomness.<a href="#section-6-27.1.1" class="pilcrow">Â¶</a></p>
<p id="section-6-27.1.2">Run RATCHET(State); ABSORB(StatePriv, Seed)<a href="#section-6-27.1.2" class="pilcrow">Â¶</a></p>
<p id="section-6-27.1.3">Return SQUEEZE(StatePriv, N).<a href="#section-6-27.1.3" class="pilcrow">Â¶</a></p>
</li>
      </ul>
<p id="section-6-28"><em>Important Note.</em> During the protocol, the implementation <em>MUST</em> make
sure that the sequence of API calls reflect the sequence provided in the
IO pattern. Calls to absorbs should be associative to provide streaming
functionalities, that is: ABSORB([one]); ABSORB([one]) should be
functionally equivalent to ABSORB([one, one]).<a href="#section-6-28" class="pilcrow">Â¶</a></p>
<p id="section-6-29">Same goes for SQUEEZE.<a href="#section-6-29" class="pilcrow">Â¶</a></p>
<p id="section-6-30">Roughly speaking, since the information about the length and the data
type is provided in the IO pattern, during the protocol execution the
hash is essentially just concatenating inputs without worrying about
data length, separators, markers for the state, etc.<a href="#section-6-30" class="pilcrow">Â¶</a></p>
<p id="section-6-31">The framework can be used inside algebraic SNARKs without any online
cost, since the IO pattern can be pre-computed outside of the circuit.
Moreover, it is compatible with algebraic hashes, so protocol developers
don't have to develop new forms of encoding for length and markers for
each different field. Protocol composition can be achieved by simply
concatenating IO patterns. Overall, the above API provides better
efficiency and security for real-world protocols.<a href="#section-6-31" class="pilcrow">Â¶</a></p>
<p id="section-6-32"><strong>Arthur: the non-interactive Verifier.</strong> We offer the following API for
the verifier of a non-interactive proof using the Fiat-Shamir heuristic.
For the technical audience, this is essentially
<a href="https://eprint.iacr.org/2023/522">[SAFE]{.underline}</a> with a byte
interface.<a href="#section-6-32" class="pilcrow">Â¶</a></p>
<ul class="normal">
<li class="normal" id="section-6-33.1">
          <p id="section-6-33.1.1">START(IO, Transcript) -&gt; State<a href="#section-6-33.1.1" class="pilcrow">Â¶</a></p>
</li>
      </ul>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-6-34.1">
          <p id="section-6-34.1.1">Store the IO Pattern as a queue.<a href="#section-6-34.1.1" class="pilcrow">Â¶</a></p>
<p id="section-6-34.1.2">Hash the IO pattern IO into 32 bytes ( ABSORB and SQUEEZE); use the
result to initialize a duplex hash State.<a href="#section-6-34.1.2" class="pilcrow">Â¶</a></p>
</li>
      </ul>
<ul class="normal">
<li class="normal" id="section-6-35.1">
          <p id="section-6-35.1.1">READ(State, N) -&gt; Input[N]<a href="#section-6-35.1.1" class="pilcrow">Â¶</a></p>
</li>
      </ul>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-6-36.1">
          <p id="section-6-36.1.1">Read the Transcript deserializing N elements until Input[] is
filled.<a href="#section-6-36.1.1" class="pilcrow">Â¶</a></p>
<p id="section-6-36.1.2">Absorb Input[]into the duplex hash.<a href="#section-6-36.1.2" class="pilcrow">Â¶</a></p>
<p id="section-6-36.1.3">Pop (or decrease) the head of the queue, throwing an error if
Operation is not A or Length&lt;0.<a href="#section-6-36.1.3" class="pilcrow">Â¶</a></p>
</li>
      </ul>
<ul class="normal">
<li class="normal" id="section-6-37.1">
          <p id="section-6-37.1.1">SQUEEZE(State, N) -&gt; Output[N]<a href="#section-6-37.1.1" class="pilcrow">Â¶</a></p>
</li>
      </ul>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-6-38.1">
          <p id="section-6-38.1.1">Squeeze Output[] elements from the duplex hash and return them<a href="#section-6-38.1.1" class="pilcrow">Â¶</a></p>
<p id="section-6-38.1.2">Pop (or decrease) the head of the queue, throwing an error if
Operation is not S or Length&lt;0.<a href="#section-6-38.1.2" class="pilcrow">Â¶</a></p>
</li>
      </ul>
<ul class="normal">
<li class="normal" id="section-6-39.1">
          <p id="section-6-39.1.1">RATCHET(State)<a href="#section-6-39.1.1" class="pilcrow">Â¶</a></p>
</li>
      </ul>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-6-40.1">
          <p id="section-6-40.1.1">Invoke ratchet from the duplex hash and clear any additional state.<a href="#section-6-40.1.1" class="pilcrow">Â¶</a></p>
<p id="section-6-40.1.2">Pop the head of the queue, throwing an error if Operation is not R.<a href="#section-6-40.1.2" class="pilcrow">Â¶</a></p>
</li>
      </ul>
<ul class="normal">
<li class="normal" id="section-6-41.1">
          <p id="section-6-41.1.1">FINISH(State)<a href="#section-6-41.1.1" class="pilcrow">Â¶</a></p>
</li>
      </ul>
<p id="section-6-42">Throw an error if the queue is not empty or Transcript is not fully
read.<a href="#section-6-42" class="pilcrow">Â¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-6-43.1">
          <p id="section-6-43.1.1">Delete the state.<a href="#section-6-43.1.1" class="pilcrow">Â¶</a></p>
</li>
      </ul>
</section>
</div>
<div id="serialization-and-conversion-of-elements">
<section id="section-7">
      <h2 id="name-serialization-and-conversio">
<a href="#section-7" class="section-number selfRef">7. </a><a href="#name-serialization-and-conversio" class="section-name selfRef">Serialization and conversion of Elements</a>
      </h2>
<p id="section-7-1">The above API only covers actions over native elements. Oftentimes, we
want to send more complex structures. Note that it's important the
encoding size of the elements is fixed and can be statically determined.<a href="#section-7-1" class="pilcrow">Â¶</a></p>
<p id="section-7-2">In the case of integers mod N to be encoded as bytes, the element is
seen as an integer between 0 and N-1 encoded in big endian. Elliptic
curve elements are encoded serializing the x coordinate with two bits to
encode whether y is positive, negative, or infinity.<a href="#section-7-2" class="pilcrow">Â¶</a></p>
<p id="section-7-3">When squeezing bits from native elements mod N, the lowest L bits are
guaranteed to be indistinguishable from uniformly random if<a href="#section-7-3" class="pilcrow">Â¶</a></p>
<p id="section-7-4">L + 1 + N.bit_length() - (alpha := N % 2 ** n).bit_length() -(2 **
N - alpha).bit_length() &gt;= 128<a href="#section-7-4" class="pilcrow">Â¶</a></p>
<p id="section-7-5">We require a potential function SQUEEZE_BITS to return the above number
of bits and discard the remaining elements of the native squeezed
elements.<a href="#section-7-5" class="pilcrow">Â¶</a></p>
</section>
</div>
<div id="additional-material">
<section id="section-8">
      <h2 id="name-additional-material">
<a href="#section-8" class="section-number selfRef">8. </a><a href="#name-additional-material" class="section-name selfRef">Additional Material</a>
      </h2>
<p id="section-8-1"><a href="https://github.com/mmaker/nimue">[Reference
implementation]{.underline}</a> (with
examples), <a href="https://eprint.iacr.org/2023/520">[Proofs of
security]{.underline}</a>.<a href="#section-8-1" class="pilcrow">Â¶</a></p>
</section>
</div>
<div id="authors-addresses">
<section id="appendix-A">
      <h2 id="name-authors-address">
<a href="#name-authors-address" class="section-name selfRef">Author's Address</a>
      </h2>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Michele OrrÃ¹</span></div>
<div dir="auto" class="left"><span class="org">CNRS</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:m@orru.net" class="email">m@orru.net</a>
</div>
</address>
</section>
</div>
<script>const toc = document.getElementById("toc");
toc.querySelector("h2").addEventListener("click", e => {
  toc.classList.toggle("active");
});
toc.querySelector("nav").addEventListener("click", e => {
  toc.classList.remove("active");
});
</script>
</body>
</html>
